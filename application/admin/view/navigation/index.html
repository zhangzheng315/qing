<!doctype html>
<html class="x-admin-sm">
    <head>
        <meta charset="UTF-8">
        <title>后台登录-角色管理</title>
        <meta name="renderer" content="webkit|ie-comp|ie-stand">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <meta name="viewport" content="width=device-width,user-scalable=yes, minimum-scale=0.4, initial-scale=0.8,target-densitydpi=low-dpi" />
        <meta http-equiv="Cache-Control" content="no-siteapp" />
        <link rel="stylesheet" href="/static/admin/css/font.css">
        <link rel="stylesheet" href="/static/admin/css/xadmin.css">
        <!-- <link rel="stylesheet" href="./css/theme5.css"> -->
        <script src="/static/admin/lib/layui/layui.js" charset="utf-8"></script>
        <script type="text/javascript" src="/static/admin/js/xadmin.js"></script>
        <script src="https://www.jq22.com/jquery/jquery-2.1.1.js"></script>
        <!-- 让IE8/9支持媒体查询，从而兼容栅格 -->
        <!--[if lt IE 9]>
          <script src="https://cdn.staticfile.org/html5shiv/r29/html5.min.js"></script>
          <script src="https://cdn.staticfile.org/respond.js/1.4.2/respond.min.js"></script>
        <![endif]-->
        <style>
            .layui-btn{
                margin-top: 8px;
                margin-left: 5px;
            }
            #add{
                padding-top: 20px;
                padding-right: 30px;
            }
        </style>
    </head>
    <body class="index">
        {include file="common/head"}
        <!-- 中部开始 -->
        {include file="common/left"}
        <!-- 右侧主体开始 -->
        <div class="page-content">
            <div class="layui-fluid">
                <div class="layui-row layui-col-space15">
                    <div class="layui-col-md12">
                        <div class="layui-card">
                            <button class="layui-btn" onclick="add()"><i class="layui-icon"></i>增加</button>
                            <button class="layui-btn layui-btn-danger" onclick="delAll()"><i class="layui-icon"></i>批量删除</button>
                            <!-- 动态表格 -->
                            <table id="table-rule" lay-filter="table-rule"></table>
                        </div>
                    </div>
                </div>
            </div> 
           
        </div>
        <!-- 中部结束 -->
        <div id="add" style="display: none;">
            <form class="layui-form"> <!-- 提示：如果你不想用form，你可以换成div等任何一个普通元素 -->
                <div class="layui-form-item">
                  <label class="layui-form-label">菜单名称</label>
                  <div class="layui-input-block">
                    <input type="text" name="menu_name" placeholder="请输入" autocomplete="off" class="layui-input">
                  </div>
                </div>
<!--                <div class="layui-form-item">-->
<!--                    <label class="layui-form-label">路由</label>-->
<!--                    <div class="layui-input-block">-->
<!--                      <input type="text" name="route" placeholder="请输入(/admin/index/index)" autocomplete="off" class="layui-input">-->
<!--                    </div>-->
<!--                </div>-->
                <div class="layui-form-item">
                  <label class="layui-form-label">启用</label>
                  <div class="layui-input-block">
                    <input name="status" value="1" type="checkbox" checked lay-skin="switch">
                  </div>
                </div>
                <div class="layui-form-item">
                    <label class="layui-form-label">排序</label>
                    <div class="layui-input-block">
                      <input type="text" name="order" placeholder="请输入(数值越大，排序越靠前)" autocomplete="off" class="layui-input">
                    </div>
                  </div>
                <div class="layui-form-item">
                  <div class="layui-input-block">
                    <button class="layui-btn" lay-submit lay-filter="add">保存</button>
                  </div>
                </div>
                <!-- 更多表单结构排版请移步文档左侧【页面元素-表单】一项阅览 -->
              </form>
        </div>
        <script>
            layui.use(['laydate','form','table'], function(){
              var laydate = layui.laydate;
              var form = layui.form;
              var table = layui.table;
              
              //执行一个laydate实例
              laydate.render({
                elem: '#start' //指定元素
              });
              //执行一个laydate实例
              laydate.render({
                elem: '#end' //指定元素
              });

            //创建动态表格
            table.render({
                elem: '#table-rule'
                ,height: 850
                ,url: '/admin/navigation/getNavigationList' //数据接口
                ,page: true //开启分页
                ,cols: [[ //表头
                {
                    field: 'id', title: 'ID', width:80, sort: true, fixed: 'left'}
                    ,{field: 'menu_name', title: '菜单名称' }
                    // ,{field: 'route', title: '路由'}
                    ,{field: 'order', title: '排序'}
                    ,{field: 'status', title: '状态'}
                    ,{field: '', title: '操作'}
                ]]
            });

            //新增
            window.add = function(){
                layer.open({
                type: 1,
                title:'新增',
                area: ['700px', '450px'],
                content: $('#add') //这里content是一个DOM，注意：最好该元素要存放在body最外层，否则可能被其它的相对元素所影响
                });
            }

              //监听提交
            form.on('submit(add)', function(data){
                $.post('/admin/navigation/navigationCreate',data.field,(res)=>{
                    if(res.status === 200){
                        layer.msg(res.message);
                        setTimeout(()=>{
                            window.location.reload()
                        },500)
                    }else{
                        layer.msg(res.message);
                    }
                })
                return false;
            });

            });
      
             /*用户-停用*/
            function member_stop(obj,id){
                layer.confirm('确认要停用吗？',function(index){
      
                    if($(obj).attr('title')=='启用'){
      
                      //发异步把用户状态进行更改
                      $(obj).attr('title','停用')
                      $(obj).find('i').html('&#xe62f;');
      
                      $(obj).parents("tr").find(".td-status").find('span').addClass('layui-btn-disabled').html('已停用');
                      layer.msg('已停用!',{icon: 5,time:1000});
      
                    }else{
                      $(obj).attr('title','启用')
                      $(obj).find('i').html('&#xe601;');
      
                      $(obj).parents("tr").find(".td-status").find('span').removeClass('layui-btn-disabled').html('已启用');
                      layer.msg('已启用!',{icon: 5,time:1000});
                    }
                    
                });
            }
      
            /*用户-删除*/
            function member_del(obj,id){
                layer.confirm('确认要删除吗？',function(index){
                    //发异步删除数据
                    $(obj).parents("tr").remove();
                    layer.msg('已删除!',{icon:1,time:1000});
                });
            }
      
            function delAll (argument) {
      
              var data = tableCheck.getData();
        
              layer.confirm('确认要删除吗？'+data,function(index){
                  //捉到所有被选中的，发异步进行删除
                  layer.msg('删除成功', {icon: 1});
                  $(".layui-form-checked").not('.header').parents('tr').remove();
              });
            }
          </script>
    </body>

</html>